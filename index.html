<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Discord Token Lookup</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #36393f;
      color: #dcddde;
      padding: 20px;
      margin: 0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: #2f3136;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    h1 {
      color: #fff;
      text-align: center;
      margin-bottom: 20px;
      font-size: 28px;
    }
    .input-group {
      display: flex;
      margin-bottom: 15px;
    }
    input {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      background-color: #40444b;
      border: none;
      color: #dcddde;
      border-radius: 4px 0 0 4px;
    }
    .eye-btn {
      background-color: #40444b;
      border: none;
      color: #dcddde;
      padding: 0 12px;
      cursor: pointer;
      border-radius: 0 4px 4px 0;
    }
    .lookup-btn {
      width: 100%;
      padding: 12px;
      background-color: #5865f2;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .lookup-btn:hover {
      background-color: #4752c4;
    }
    .hidden {
      display: none;
    }
    .user-card {
      display: flex;
      background-color: #40444b;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }
    .avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid #5865f2;
    }
    .user-info {
      margin-left: 20px;
      flex: 1;
    }
    .username {
      font-size: 24px;
      font-weight: bold;
      color: white;
      display: flex;
      align-items: center;
    }
    .badge {
      display: inline-block;
      margin-left: 8px;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: normal;
    }
    .nitro-badge {
      background-color: #ff73fa;
      color: #fff;
    }
    .verified-badge {
      background-color: #3ba55c;
      color: #fff;
    }
    .info-section {
      margin-top: 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .info-item {
      background-color: #2f3136;
      padding: 10px;
      border-radius: 4px;
    }
    .info-label {
      font-weight: bold;
      color: #b9bbbe;
      margin-bottom: 5px;
    }
    .info-value {
      color: #fff;
    }
    .tabs {
      display: flex;
      margin-top: 20px;
      border-bottom: 1px solid #40444b;
    }
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
    }
    .tab.active {
      border-bottom: 2px solid #5865f2;
      color: #fff;
    }
    .tab-content {
      padding: 15px 0;
    }
    .error-message {
      background-color: #f04747;
      color: white;
      padding: 10px;
      border-radius: 4px;
      margin-top: 10px;
      text-align: center;
    }
    .loading {
      text-align: center;
      padding: 20px;
      color: #b9bbbe;
    }
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .friend-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 10px;
    }
    .friend-item {
      background-color: #40444b;
      border-radius: 4px;
      padding: 10px;
      display: flex;
      align-items: center;
    }
    .friend-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
    }
    .friend-name {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .guild-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
    }
    .guild-item {
      background-color: #40444b;
      border-radius: 4px;
      padding: 10px;
      text-align: center;
    }
    .guild-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin-bottom: 5px;
    }
    .guild-name {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 14px;
    }
    .copy-btn {
      cursor: pointer;
      background: none;
      border: none;
      color: #5865f2;
      margin-left: 5px;
    }
    .tooltip {
      position: relative;
    }
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 100px;
      background-color: #000;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -50px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
    }
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1><i class="fab fa-discord"></i> Discord Token Lookup</h1>
    
    <div class="input-group">
      <input type="password" id="tokenInput" placeholder="Enter your Discord token">
      <button id="toggleVisibility" class="eye-btn"><i class="fas fa-eye"></i></button>
    </div>
    
    <button id="lookupBtn" class="lookup-btn">Lookup</button>
    
    <div id="loadingSpinner" class="hidden loading">
      <div class="spinner"></div> Fetching Discord data...
    </div>
    
    <div id="errorMessage" class="hidden error-message">
      <i class="fas fa-exclamation-circle"></i> Invalid token or error fetching data.
    </div>
    
    <div id="resultContainer" class="hidden">
      <div class="user-card">
        <img id="avatar" src="/api/placeholder/100/100" class="avatar" alt="Avatar">
        <div class="user-info">
          <div class="username">
            <span id="username">Username</span>
            <span id="discriminator">#0000</span>
            <span id="nitroBadge" class="badge nitro-badge hidden">Nitro</span>
            <span id="verifiedBadge" class="badge verified-badge hidden">Verified</span>
          </div>
          
          <div class="info-section">
            <div class="info-item">
              <div class="info-label">User ID</div>
              <div class="info-value tooltip">
                <span id="userId">000000000000000000</span>
                <button class="copy-btn" data-copy="userId"><i class="fas fa-copy"></i></button>
                <span class="tooltip-text">Copy ID</span>
              </div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Email</div>
              <div class="info-value tooltip">
                <span id="email">example@discord.com</span>
                <button class="copy-btn" data-copy="email"><i class="fas fa-copy"></i></button>
                <span class="tooltip-text">Copy Email</span>
              </div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Phone</div>
              <div class="info-value" id="phone">Not set</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">MFA Status</div>
              <div class="info-value" id="mfa">Disabled</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Creation Date</div>
              <div class="info-value" id="creationDate">Jan 1, 2000</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Bio</div>
              <div class="info-value" id="bio">No bio set</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="tabs">
        <div class="tab active" data-tab="profile">Profile</div>
        <div class="tab" data-tab="friends">Friends</div>
        <div class="tab" data-tab="guilds">Servers</div>
        <div class="tab" data-tab="billing">Billing</div>
      </div>
      
      <div class="tab-content">
        <div id="profileTab" class="tab-panel">
          <div class="info-section">
            <div class="info-item">
              <div class="info-label">Locale</div>
              <div class="info-value" id="locale">en-US</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Theme</div>
              <div class="info-value" id="theme">Dark</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Banner Color</div>
              <div class="info-value" id="bannerColor">None</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Accent Color</div>
              <div class="info-value" id="accentColor">None</div>
            </div>
          </div>
        </div>
        
        <div id="friendsTab" class="tab-panel hidden">
          <div id="friendList" class="friend-list">
            <div class="loading">
              <div class="spinner"></div> Loading friends...
            </div>
          </div>
        </div>
        
        <div id="guildsTab" class="tab-panel hidden">
          <div id="guildList" class="guild-list">
            <div class="loading">
              <div class="spinner"></div> Loading servers...
            </div>
          </div>
        </div>
        
        <div id="billingTab" class="tab-panel hidden">
          <div class="info-section">
            <div class="info-item">
              <div class="info-label">Payment Method</div>
              <div class="info-value" id="paymentMethod">None</div>
            </div>
            
            <div class="info-item">
              <div class="info-label">Subscription</div>
              <div class="info-value" id="subscription">None</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Basic elements
      const tokenInput = document.getElementById('tokenInput');
      const toggleVisibility = document.getElementById('toggleVisibility');
      const lookupBtn = document.getElementById('lookupBtn');
      const resultContainer = document.getElementById('resultContainer');
      const loadingSpinner = document.getElementById('loadingSpinner');
      const errorMessage = document.getElementById('errorMessage');
      
      // Tab elements
      const tabs = document.querySelectorAll('.tab');
      const tabPanels = document.querySelectorAll('.tab-panel');
      
      // Current user data
      let userData = null;
      let currentToken = null;
      
      // Toggle password visibility
      let isTokenVisible = false;
      toggleVisibility.addEventListener('click', function () {
        isTokenVisible = !isTokenVisible;
        tokenInput.type = isTokenVisible ? 'text' : 'password';
        toggleVisibility.innerHTML = isTokenVisible ?
          '<i class="fas fa-eye-slash"></i>' :
          '<i class="fas fa-eye"></i>';
      });
      
      // Tab switching
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          const tabName = this.getAttribute('data-tab');
          
          // Update active tab
          tabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          
          // Show correct panel
          tabPanels.forEach(panel => panel.classList.add('hidden'));
          document.getElementById(tabName + 'Tab').classList.remove('hidden');
          
          // Load additional data if needed
          if (tabName === 'friends' && currentToken) {
            loadFriends(currentToken);
          } else if (tabName === 'guilds' && currentToken) {
            loadGuilds(currentToken);
          } else if (tabName === 'billing' && currentToken) {
            loadBillingInfo(currentToken);
          }
        });
      });
      
      // Copy button functionality
      document.addEventListener('click', function(e) {
        if (e.target.closest('.copy-btn')) {
          const button = e.target.closest('.copy-btn');
          const field = button.getAttribute('data-copy');
          const text = document.getElementById(field).textContent;
          
          navigator.clipboard.writeText(text).then(() => {
            const tooltip = button.nextElementSibling;
            const originalText = tooltip.textContent;
            tooltip.textContent = 'Copied!';
            
            setTimeout(() => {
              tooltip.textContent = originalText;
            }, 1500);
          });
        }
      });
      
      // Main lookup function
      lookupBtn.addEventListener('click', async function () {
        const token = tokenInput.value.trim();
        currentToken = token;
        
        if (!token) {
          errorMessage.textContent = 'Please enter a Discord token';
          errorMessage.classList.remove('hidden');
          return;
        }
        
        // Reset UI
        resultContainer.classList.add('hidden');
        errorMessage.classList.add('hidden');
        loadingSpinner.classList.remove('hidden');
        
        try {
          // Get user data
          const response = await fetch('https://tokenlookup.onrender.com/proxy', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              endpoint: 'users/@me',
              method: 'GET',
              token: token
            })
          });
          
          loadingSpinner.classList.add('hidden');
          
          if (!response.ok) {
            errorMessage.classList.remove('hidden');
            return;
          }
          
          userData = await response.json();
          
          // Update UI with user data
          updateUserProfile(userData);
          
          // Reset to profile tab
          tabs.forEach(t => t.classList.remove('active'));
          tabs[0].classList.add('active');
          tabPanels.forEach(panel => panel.classList.add('hidden'));
          document.getElementById('profileTab').classList.remove('hidden');
          
          resultContainer.classList.remove('hidden');
        } catch (err) {
          console.error(err);
          loadingSpinner.classList.add('hidden');
          errorMessage.classList.remove('hidden');
        }
      });
      
      // Update user profile UI
      function updateUserProfile(data) {
        // Basic info
        document.getElementById('username').textContent = data.username || 'N/A';
        document.getElementById('discriminator').textContent = data.discriminator ? `#${data.discriminator}` : '';
        document.getElementById('userId').textContent = data.id || 'N/A';
        document.getElementById('email').textContent = data.email || 'Not available';
        document.getElementById('phone').textContent = data.phone || 'Not set';
        document.getElementById('mfa').textContent = data.mfa_enabled ? 'Enabled' : 'Disabled';
        
        // Avatar
        if (data.avatar) {
          const avatarUrl = `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png?size=256`;
          document.getElementById('avatar').src = avatarUrl;
        } else {
          const defaultAvatarNumber = data.discriminator ? parseInt(data.discriminator) % 5 : 0;
          document.getElementById('avatar').src = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarNumber}.png`;
        }
        
        // Badges
        const nitroBadge = document.getElementById('nitroBadge');
        if (data.premium_type > 0) {
          nitroBadge.textContent = data.premium_type === 2 ? 'Nitro' : 'Classic';
          nitroBadge.classList.remove('hidden');
        } else {
          nitroBadge.classList.add('hidden');
        }
        
        const verifiedBadge = document.getElementById('verifiedBadge');
        if (data.verified) {
          verifiedBadge.classList.remove('hidden');
        } else {
          verifiedBadge.classList.add('hidden');
        }
        
        // Creation date
        const createdAt = new Date(Number((BigInt(data.id) >> 22n) + 1420070400000n));
        document.getElementById('creationDate').textContent = createdAt.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
        
        // Bio and additional info
        document.getElementById('bio').textContent = data.bio || 'No bio set';
        document.getElementById('locale').textContent = data.locale || 'en-US';
        document.getElementById('theme').textContent = data.theme || 'Dark';
        
        // Display colors if available
        if (data.banner_color) {
          document.getElementById('bannerColor').textContent = data.banner_color;
          document.getElementById('bannerColor').style.color = data.banner_color;
        } else {
          document.getElementById('bannerColor').textContent = 'None';
        }
        
        if (data.accent_color) {
          const hexColor = '#' + data.accent_color.toString(16).padStart(6, '0');
          document.getElementById('accentColor').textContent = hexColor;
          document.getElementById('accentColor').style.color = hexColor;
        } else {
          document.getElementById('accentColor').textContent = 'None';
        }
      }
      
      // Load friends list
      async function loadFriends(token) {
        const friendList = document.getElementById('friendList');
        friendList.innerHTML = '<div class="loading"><div class="spinner"></div> Loading friends...</div>';
        
        try {
          const response = await fetch('https://tokenlookup.onrender.com/proxy', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              endpoint: 'users/@me/relationships',
              method: 'GET',
              token: token
            })
          });
          
          if (!response.ok) {
            friendList.innerHTML = '<div class="error-message">Failed to load friends</div>';
            return;
          }
          
          const friends = await response.json();
          
          if (friends.length === 0) {
            friendList.innerHTML = '<div style="padding: 20px; text-align: center;">No friends found</div>';
            return;
          }
          
          friendList.innerHTML = '';
          
          friends.forEach(friend => {
            if (friend.type === 1) { // Type 1 means accepted friend
              const friendItem = document.createElement('div');
              friendItem.className = 'friend-item';
              
              let avatarUrl = '/api/placeholder/40/40';
              if (friend.user.avatar) {
                avatarUrl = `https://cdn.discordapp.com/avatars/${friend.user.id}/${friend.user.avatar}.png?size=128`;
              } else {
                const defaultAvatar = friend.user.discriminator ? parseInt(friend.user.discriminator) % 5 : 0;
                avatarUrl = `https://cdn.discordapp.com/embed/avatars/${defaultAvatar}.png`;
              }
              
              friendItem.innerHTML = `
                <img src="${avatarUrl}" class="friend-avatar" alt="Friend">
                <div class="friend-name">
                  ${friend.user.username}${friend.user.discriminator ? `#${friend.user.discriminator}` : ''}
                </div>
              `;
              
              friendList.appendChild(friendItem);
            }
          });
          
          if (friendList.children.length === 0) {
            friendList.innerHTML = '<div style="padding: 20px; text-align: center;">No friends found</div>';
          }
        } catch (err) {
          console.error(err);
          friendList.innerHTML = '<div class="error-message">Failed to load friends</div>';
        }
      }
      
      // Load guilds/servers
      async function loadGuilds(token) {
        const guildList = document.getElementById('guildList');
        guildList.innerHTML = '<div class="loading"><div class="spinner"></div> Loading servers...</div>';
        
        try {
          const response = await fetch('https://tokenlookup.onrender.com/proxy', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              endpoint: 'users/@me/guilds',
              method: 'GET',
              token: token
            })
          });
          
          if (!response.ok) {
            guildList.innerHTML = '<div class="error-message">Failed to load servers</div>';
            return;
          }
          
          const guilds = await response.json();
          
          if (guilds.length === 0) {
            guildList.innerHTML = '<div style="padding: 20px; text-align: center;">No servers found</div>';
            return;
          }
          
          guildList.innerHTML = '';
          
          guilds.forEach(guild => {
            const guildItem = document.createElement('div');
            guildItem.className = 'guild-item';
            
            let iconUrl = '/api/placeholder/60/60';
            if (guild.icon) {
              iconUrl = `https://cdn.discordapp.com/icons/${guild.id}/${guild.icon}.png?size=128`;
            }
            
            guildItem.innerHTML = `
              <img src="${iconUrl}" class="guild-avatar" alt="Server">
              <div class="guild-name" title="${guild.name}">
                ${guild.name}
              </div>
            `;
            
            guildList.appendChild(guildItem);
          });
        } catch (err) {
          console.error(err);
          guildList.innerHTML = '<div class="error-message">Failed to load servers</div>';
        }
      }
      
      // Load billing information
      async function loadBillingInfo(token) {
        try {
          const response = await fetch('https://tokenlookup.onrender.com/proxy', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              endpoint: 'users/@me/billing/payment-sources',
              method: 'GET',
              token: token
            })
          });
          
          if (!response.ok) {
            document.getElementById('paymentMethod').textContent = 'Failed to load';
            return;
          }
          
          const paymentSources = await response.json();
          
          if (paymentSources.length === 0) {
            document.getElementById('paymentMethod').textContent = 'No payment methods';
          } else {
            const methods = [];
            paymentSources.forEach(source => {
              if (source.type === 1) {
                methods.push('Credit Card');
              } else if (source.type === 2) {
                methods.push('PayPal');
              } else {
                methods.push('Other');
              }
            });
            document.getElementById('paymentMethod').textContent = methods.join(', ');
          }
          
          // Get subscription info
          const subResponse = await fetch('https://tokenlookup.onrender.com/proxy', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              endpoint: 'users/@me/billing/subscriptions',
              method: 'GET',
              token: token
            })
          });
          
          if (!subResponse.ok) {
            document.getElementById('subscription').textContent = 'Failed to load';
            return;
          }
          
          const subscriptions = await subResponse.json();
          
          if (subscriptions.length === 0) {
            document.getElementById('subscription').textContent = 'No active subscriptions';
          } else {
            document.getElementById('subscription').textContent = 'Active - ' + subscriptions.length + ' subscription(s)';
          }
        } catch (err) {
          console.error(err);
          document.getElementById('paymentMethod').textContent = 'Failed to load';
          document.getElementById('subscription').textContent = 'Failed to load';
        }
      }
    });
  </script>
</body>
</html>